---
title: Exploratory Data Analysis
format: typst
---

### Question 1

What percentage of precincts were won by Democrats vs Republicans?

### Answer 1

```{r}
percentage <- cleaned %>%
  mutate(winner = if_else(demvote > repvote, "Democrat", "Republican")) %>%
  count(winner) %>%
  mutate(percent = n / sum(n))

print(percentage)
```

### Question 2

How do turnout rate vary across precincts?

### Answer 2

```{r}
library(ggplot2)
cleaned %>%
  mutate(turnout = totvote / totreg) %>%
  ggplot(aes(x = turnout)) +
  geom_histogram(bins = 50) +
  labs(title = "Distribution of Precinct Turnout",
       x = "Turnout rate", 
       y = "Number of precincts") +
  coord_cartesian(xlim = c(0, 4))  
```

### Question 3

Which districts had the smallest margins of votes between democrats and republicans?

### Answer 3

```{r}
district_margins <- cleaned %>%
  group_by(cddist) %>%
  summarise(
    dem_total = sum(demvote, na.rm = TRUE),
    rep_total = sum(repvote, na.rm = TRUE),
    margin = abs(dem_total - rep_total) / (dem_total + rep_total)
  ) %>%
  arrange(margin)

head(district_margins, 5)
tail(district_margins, 5)
```